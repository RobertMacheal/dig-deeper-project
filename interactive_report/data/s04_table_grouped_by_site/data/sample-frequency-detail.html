<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>q2_feature_table : summarize</title>
    <link rel="stylesheet" href="./q2templateassets/css/bootstrap.min.css"/>
    <link rel="stylesheet" href="./q2templateassets/css/normalize.css"/>
    <link rel="stylesheet" href="./q2templateassets/css/base-template.css"/>
    <script src="./q2templateassets/js/jquery-3.2.0.min.js" charset="utf-8"></script>
    <script src="./q2templateassets/js/bootstrap.min.js" charset="utf-8"></script>
    
<script src="js/vega.min.js"></script>
<script src="js/vega-embed.min.js"></script>
<link rel="stylesheet" type="text/css" href="css/spinkit.css" /> 
  </head>
  <body>
    <div class="container-fluid">
      <div id="q2templatesheader" class="row">
        <div class="col-lg-12">
          <a href="http://qiime2.org/">
            <img src="./q2templateassets/img/qiime2-rect-200.png"
            alt="QIIME 2">
          </a>
        </div>
      </div>
        

  <div class="row">
    <div class="col-lg-12">
      <ul class="nav nav-tabs">
        
          <li class="">
            <a href="index.html">
              Overview
            </a>
          </li>
        
          <li class="active">
            <a href="sample-frequency-detail.html">
              Interactive Sample Detail
            </a>
          </li>
        
          <li class="">
            <a href="feature-frequency-detail.html">
              Feature Detail
            </a>
          </li>
        
      </ul>
    </div>
  </div>
  <div class="row">
    <div class="col-lg-12">
      


<div class="row">

  <div class="col-lg-8">
    <div id="plot">
      <div id="loading" class="spinner">
        <div class="rect1"></div>
        <div class="rect2"></div>
        <div class="rect3"></div>
        <div class="rect4"></div>
        <div class="rect5"></div>
      </div>
    </div>
  </div>

  <div class="col-lg-4">
    <div class="row">
      <div class="col-lg-12">
        <h3>Plot Controls</h3>
      </div>
    </div>

    <div class="row">
      <div class="col-lg-12" id="toolbar"></div>
    </div>

    <div class="row">
      <div class="col-lg-12" id="metadata-category"></div>
    </div>

    <div class="row">
      <div class="col-lg-12" id="sampling-depth-slider"></div>
    </div>

    <div class="row">
      <div class="col-lg-12" id="text-field"></div>
    </div>
  </div>

</div>






<script type="text/javascript">
  function handleErrors(errors, element, msg) {
    console.error(errors);
    msg = msg === undefined ? '' : msg + '<br><br>';
    var helpMsg = '<p class="alert alert-danger"> \
                   There was an error loading and rendering the \
                   visualization.<br><br>' + msg + 'Please \
                   copy-and-paste the following error messages when \
                   reporting this error (please be aware that the content \
                   of your analysis data and/or metadata is included in \
                   these messages):</p>';
    var helpMsgDiv = $('<div></div>');
    helpMsgDiv.append(helpMsg);
    helpMsgDiv.append('<pre><code>' + errors.join('\n\n') + '</code></pre>');
    element.replaceWith(helpMsgDiv);
  }
  window.onerror = function(error) {
    handleErrors([error], $('#loading'));
  };
</script>
<script id="spec" type="application/json">
{"$schema": "https://vega.github.io/schema/vega/v5.json", "autosize": {"contains": "content", "type": "fit-x", "resize": true}, "width": 800, "data": [{"transform": [{"as": "selectedCategory", "expr": "datum.metadata[category]", "type": "formula"}], "name": "table", "values": [{"id": "Whitelands_2018/19_", "metadata": {"Year_est": "2018", "Age": "3", "OS_location": "SU2990087100", "Lat_long": "51.581972; -1.5698756", "Establishment": "seed_mix", "pH": 8.03, "EC": 136.4, "Cutting": 0.0, "Cattle": 0.0, "Sheep": 1.0, "Plough": "1"}, "frequency": 25680.0}, {"id": "Castle_Field_West_(W)", "metadata": {"Year_est": "2002", "Age": "19", "OS_location": "SU2950086200", "Lat_long": "51.573901; -1.5757235", "Establishment": "seed_mix", "pH": 7.93, "EC": 139.3, "Cutting": 0.0, "Cattle": 1.0, "Sheep": 1.0, "Plough": "1"}, "frequency": 24979.0}, {"id": "Toposcope_Field_-_1980s", "metadata": {"Year_est": "1985", "Age": "36", "OS_location": "SU2950086600", "Lat_long": "51.577497; -1.5756901", "Establishment": "Natural_regen", "pH": 7.94, "EC": 139.7, "Cutting": 0.0, "Cattle": 1.0, "Sheep": 1.0, "Plough": "0"}, "frequency": 33224.0}, {"id": "Bradenham_post-1986_b", "metadata": {"Year_est": "1986", "Age": "35", "OS_location": "SU8290097718", "Lat_long": "51.672127; -0.80258692", "Establishment": "seed_mix", "pH": 7.84, "EC": 151.7, "Cutting": 0.0, "Cattle": 1.0, "Sheep": 1.0, "Plough": "1"}, "frequency": 39538.0}, {"id": "Lardon_Chase_The_Holies_motorcycle", "metadata": {"Year_est": "2007", "Age": "14", "OS_location": "SU5930079800", "Lat_long": "51.514021; -1.1468383", "Establishment": "Natural_regen", "pH": 7.94, "EC": 135.7, "Cutting": 0.0, "Cattle": 0.0, "Sheep": 1.0, "Plough": "0"}, "frequency": 18721.0}, {"id": "Stonehenge_2000_2017a", "metadata": {"Year_est": "2000", "Age": "21", "OS_location": "SU1370042400", "Lat_long": "51.180671; -1.8053828", "Establishment": "Green_hay/bush", "pH": 7.88, "EC": 144.3, "Cutting": 0.0, "Cattle": 1.0, "Sheep": 1.0, "Plough": "1"}, "frequency": 38504.0}, {"id": "Stonehenge_2003_2017b", "metadata": {"Year_est": "2003", "Age": "18", "OS_location": "SU1150041600", "Lat_long": "51.173525; -1.8368821", "Establishment": "Green_hay/bush", "pH": 7.69, "EC": 184.4, "Cutting": 0.0, "Cattle": 1.0, "Sheep": 1.0, "Plough": "1"}, "frequency": 35169.0}, {"id": "Stonehenge_2009", "metadata": {"Year_est": "2009", "Age": "12", "OS_location": "SU1050041700", "Lat_long": "51.174443; -1.8511833", "Establishment": "Green_hay/bush", "pH": 7.82, "EC": 156.5, "Cutting": 0.0, "Cattle": 0.0, "Sheep": 1.0, "Plough": "1"}, "frequency": 38690.0}, {"id": "Stonehenge_2007_2016", "metadata": {"Year_est": "2007", "Age": "14", "OS_location": "SU1100041900", "Lat_long": "51.176233; -1.8440251", "Establishment": "Green_hay/bush", "pH": 7.87, "EC": 158.8, "Cutting": 0.0, "Cattle": 1.0, "Sheep": 1.0, "Plough": "1"}, "frequency": 35339.0}, {"id": "Stonehenge_2005", "metadata": {"Year_est": "2005", "Age": "16", "OS_location": "SU1140042200", "Lat_long": "51.178922; -1.8382937", "Establishment": "Green_hay/bush", "pH": 7.85, "EC": 145.0, "Cutting": 0.0, "Cattle": 0.0, "Sheep": 1.0, "Plough": "1"}, "frequency": 36346.0}, {"id": "Stonehenge_2002_2017", "metadata": {"Year_est": "2002", "Age": "19", "OS_location": "SU1480043200", "Lat_long": "51.187837; -1.7896132", "Establishment": "Green_hay/bush", "pH": 7.91, "EC": 130.3, "Cutting": 0.0, "Cattle": 1.0, "Sheep": 1.0, "Plough": "1"}, "frequency": 36570.0}, {"id": "Stonehenge_2010", "metadata": {"Year_est": "2010", "Age": "11", "OS_location": "SU1070043000", "Lat_long": "51.186129; -1.8482842", "Establishment": "Green_hay/bush", "pH": 7.69, "EC": 202.0, "Cutting": 0.0, "Cattle": 1.0, "Sheep": 1.0, "Plough": "1"}, "frequency": 32292.0}, {"id": "Stonehenge_2011", "metadata": {"Year_est": "2011", "Age": "10", "OS_location": "SU1050043600", "Lat_long": "51.191528; -1.8511284", "Establishment": "Green_hay/bush", "pH": 7.85, "EC": 174.3, "Cutting": 0.0, "Cattle": 1.0, "Sheep": 1.0, "Plough": "1"}, "frequency": 39326.0}, {"id": "Stonehenge_-_Luxenborough_BankB", "metadata": {"Year_est": "2000", "Age": "21", "OS_location": "SU1290041900", "Lat_long": "51.176193; -1.8168457", "Establishment": "Green_hay/bush", "pH": 7.78, "EC": 186.6, "Cutting": 1.0, "Cattle": 0.0, "Sheep": 1.0, "Plough": "1"}, "frequency": 34598.0}, {"id": "Watlington_natural_reversion", "metadata": {"Year_est": "2000", "Age": "21", "OS_location": "SU7050293600", "Lat_long": "51.636798; -0.98266944", "Establishment": "Natural_regen", "pH": 7.8, "EC": 147.5, "Cutting": 0.0, "Cattle": 0.0, "Sheep": 1.0, "Plough": "0"}, "frequency": 35772.0}, {"id": "St_Catherines_A3", "metadata": {"Year_est": "1994", "Age": "27", "OS_location": "SU4812327449", "Lat_long": "51.044386; -1.3149275", "Establishment": "Green_hay/bush", "pH": 7.63, "EC": 222.0, "Cutting": 1.0, "Cattle": 1.0, "Sheep": 1.0, "Plough": "0"}, "frequency": 27693.0}, {"id": "HARLEY_FARMS_Chittern", "metadata": {"Year_est": "2013", "Age": "8", "OS_location": "ST9762044730", "Lat_long": "51.201778; -2.0354461", "Establishment": "seed_mix", "pH": 7.77, "EC": 197.9, "Cutting": 1.0, "Cattle": 1.0, "Sheep": 0.0, "Plough": "1"}, "frequency": 35642.0}, {"id": "HARLEY_FARMS_New1", "metadata": {"Year_est": "2020", "Age": "1", "OS_location": "ST9346829822", "Lat_long": "51.067692; -2.0945983", "Establishment": "seed_mix", "pH": 7.84, "EC": 144.1, "Cutting": 0.0, "Cattle": 1.0, "Sheep": 0.0, "Plough": "0"}, "frequency": 35726.0}, {"id": "HARLEY_FARMS_new2b", "metadata": {"Year_est": "2020", "Age": "1", "OS_location": "ST9242629613", "Lat_long": "51.065799; -2.1094648", "Establishment": "seed_mix", "pH": 7.09, "EC": 102.5, "Cutting": 1.0, "Cattle": 0.0, "Sheep": 0.0, "Plough": "0"}, "frequency": 35630.0}, {"id": "WINDMILL_farm", "metadata": {"Year_est": "1990", "Age": "31", "OS_location": "SU7176229761", "Lat_long": "51.06271; -0.97732036", "Establishment": "seed_mix", "pH": 7.32, "EC": 210.0, "Cutting": 1.0, "Cattle": 1.0, "Sheep": 1.0, "Plough": "1"}, "frequency": 22761.0}, {"id": "DRUIDS", "metadata": {"Year_est": "2002", "Age": "19", "OS_location": "SU2964250324", "Lat_long": "51.251319; -1.5766624", "Establishment": "seed_mix", "pH": 7.14, "EC": 176.3, "Cutting": 1.0, "Cattle": 1.0, "Sheep": 1.0, "Plough": "1"}, "frequency": 32519.0}, {"id": "Stratton_Wood", "metadata": {"Year_est": "1995", "Age": "26", "OS_location": "SU1647289260", "Lat_long": "51.601942; -1.7635665", "Establishment": "seed_mix", "pH": 7.41, "EC": 126.8, "Cutting": 1.0, "Cattle": 0.0, "Sheep": 0.0, "Plough": "1"}, "frequency": 29263.0}, {"id": "WESTMEAD_FARM", "metadata": {"Year_est": "2000", "Age": "21", "OS_location": "SU6317525168", "Lat_long": "51.022422; -1.1006408", "Establishment": "seed_mix", "pH": 7.75, "EC": 159.0, "Cutting": 1.0, "Cattle": 0.0, "Sheep": 1.0, "Plough": "0"}, "frequency": 18226.0}, {"id": "RSPB_orig_green", "metadata": {"Year_est": "2006", "Age": "15", "OS_location": "SU2135640329", "Lat_long": "51.161815; -1.6959767", "Establishment": "Green_hay/bush", "pH": 7.99, "EC": 138.1, "Cutting": 0.0, "Cattle": 1.0, "Sheep": 1.0, "Plough": "0"}, "frequency": 28826.0}, {"id": "RSPB_churchil", "metadata": {"Year_est": "2010", "Age": "11", "OS_location": "SU2075340336", "Lat_long": "51.1619; -1.7045994", "Establishment": "Green_hay/bush", "pH": 8.01, "EC": 116.8, "Cutting": 0.0, "Cattle": 0.0, "Sheep": 1.0, "Plough": "0"}, "frequency": 24264.0}, {"id": "RSPB_junction", "metadata": {"Year_est": "2007", "Age": "14", "OS_location": "SU2267739280", "Lat_long": "51.152332; -1.6771517", "Establishment": "Green_hay/bush", "pH": 8.41, "EC": 24.6, "Cutting": 0.0, "Cattle": 0.0, "Sheep": 1.0, "Plough": "0"}, "frequency": 38603.0}, {"id": "RSPB_Mainline", "metadata": {"Year_est": "2016", "Age": "5", "OS_location": "SU2250539212", "Lat_long": "51.151728; -1.6796151", "Establishment": "Green_hay/bush", "pH": 8.48, "EC": 23.4, "Cutting": 0.0, "Cattle": 0.0, "Sheep": 1.0, "Plough": "0"}, "frequency": 28713.0}, {"id": "Baltic_farm_1", "metadata": {"Year_est": "2005", "Age": "16", "OS_location": "SU0459767825", "Lat_long": "51.40943; -1.9352946", "Establishment": "Green_hay/bush", "pH": 7.94, "EC": 29.2, "Cutting": 1.0, "Cattle": 1.0, "Sheep": 1.0, "Plough": "0"}, "frequency": 17279.0}, {"id": "Baltic_farm_2", "metadata": {"Year_est": "1998", "Age": "23", "OS_location": "SU0306867167", "Lat_long": "51.403524; -1.9572835", "Establishment": "Green_hay/bush", "pH": 8.27, "EC": 29.6, "Cutting": 1.0, "Cattle": 1.0, "Sheep": 1.0, "Plough": "0"}, "frequency": 24064.0}, {"id": "WestEndFarm", "metadata": {"Year_est": "2019", "Age": "2", "OS_location": "SU0297366901", "Lat_long": "51.401133; -1.9586514", "Establishment": "Green_hay/bush", "pH": 8.44, "EC": 24.1, "Cutting": 1.0, "Cattle": 0.0, "Sheep": 1.0, "Plough": "1"}, "frequency": 13985.0}, {"id": "HorntonHouseFarm_1_parallel", "metadata": {"Year_est": "2016", "Age": "5", "OS_location": "SU0584565118", "Lat_long": "51.385079; -1.917395", "Establishment": "seed_mix", "pH": 8.6, "EC": 29.5, "Cutting": 1.0, "Cattle": 1.0, "Sheep": 1.0, "Plough": "0"}, "frequency": 21680.0}, {"id": "TownsendFarm_1", "metadata": {"Year_est": "2017", "Age": "4", "OS_location": "SU0775065316", "Lat_long": "51.386837; -1.8900159", "Establishment": "seed_mix", "pH": 8.2, "EC": 36.6, "Cutting": 1.0, "Cattle": 0.0, "Sheep": 1.0, "Plough": "0"}, "frequency": 42946.0}, {"id": "TownsendFarm_2", "metadata": {"Year_est": "2010", "Age": "11", "OS_location": "SU0705164722", "Lat_long": "51.381505; -1.9000725", "Establishment": "seed_mix", "pH": 8.45, "EC": 21.2, "Cutting": 1.0, "Cattle": 0.0, "Sheep": 1.0, "Plough": "0"}, "frequency": 25856.0}, {"id": "TownsendFarm_3_big", "metadata": {"Year_est": "2014", "Age": "7", "OS_location": "SU0886965184", "Lat_long": "51.385634; -1.8739384", "Establishment": "Green_hay/bush", "pH": 7.92, "EC": 42.7, "Cutting": 1.0, "Cattle": 0.0, "Sheep": 1.0, "Plough": "0"}, "frequency": 37937.0}, {"id": "ChurchFarm", "metadata": {"Year_est": "2012", "Age": "9", "OS_location": "SU0979864321", "Lat_long": "51.377859; -1.8606121", "Establishment": "seed_mix", "pH": 8.63, "EC": 20.7, "Cutting": 1.0, "Cattle": 1.0, "Sheep": 1.0, "Plough": "0"}, "frequency": 29146.0}, {"id": "StowellFarms_1_adj", "metadata": {"Year_est": "2015", "Age": "6", "OS_location": "SU1362464180", "Lat_long": "51.376513; -1.8056466", "Establishment": "seed_mix", "pH": 6.6, "EC": 21.8, "Cutting": 1.0, "Cattle": 1.0, "Sheep": 1.0, "Plough": "1"}, "frequency": 37901.0}, {"id": "MannorFmAltonBarnes", "metadata": {"Year_est": "2012", "Age": "9", "OS_location": "SU1211561331", "Lat_long": "51.35093; -1.827423", "Establishment": "seed_mix", "pH": 8.07, "EC": 21.6, "Cutting": 1.0, "Cattle": 1.0, "Sheep": 1.0, "Plough": "0"}, "frequency": 16267.0}, {"id": "HommingtonFarm", "metadata": {"Year_est": "2014", "Age": "7", "OS_location": "SU1332825982", "Lat_long": "51.033048; -1.811306", "Establishment": "seed_mix", "pH": 8.22, "EC": 26.3, "Cutting": 1.0, "Cattle": 1.0, "Sheep": 1.0, "Plough": "1"}, "frequency": 21063.0}, {"id": "ThropeManor_1", "metadata": {"Year_est": "2002", "Age": "19", "OS_location": "SU0886123850", "Lat_long": "51.013962; -1.8750607", "Establishment": "seed_mix", "pH": 7.54, "EC": 78.1, "Cutting": 1.0, "Cattle": 0.0, "Sheep": 1.0, "Plough": "0"}, "frequency": 11842.0}, {"id": "ThropeManor_2", "metadata": {"Year_est": "1998", "Age": "23", "OS_location": "SU0843924348", "Lat_long": "51.018447; -1.8810649", "Establishment": "seed_mix", "pH": 7.73, "EC": 28.8, "Cutting": 1.0, "Cattle": 0.0, "Sheep": 1.0, "Plough": "1"}, "frequency": 12626.0}, {"id": "ThropeManor_3", "metadata": {"Year_est": "2000", "Age": "21", "OS_location": "SU0901525189", "Lat_long": "51.026001; -1.8728325", "Establishment": "seed_mix", "pH": 8.13, "EC": 28.5, "Cutting": 1.0, "Cattle": 0.0, "Sheep": 1.0, "Plough": "0"}, "frequency": 13807.0}, {"id": "MannorFmBroadChalke", "metadata": {"Year_est": "2010", "Age": "11", "OS_location": "SU0468023121", "Lat_long": "51.007455; -1.9346701", "Establishment": "Green_hay/bush", "pH": 8.24, "EC": 24.3, "Cutting": 0.0, "Cattle": 0.0, "Sheep": 1.0, "Plough": "0"}, "frequency": 12750.0}, {"id": "BigleyFm_1", "metadata": {"Year_est": "2014", "Age": "7", "OS_location": "ST9798720966", "Lat_long": "50.988091; -2.0300532", "Establishment": "seed_mix", "pH": 8.1, "EC": 31.3, "Cutting": 1.0, "Cattle": 1.0, "Sheep": 1.0, "Plough": "1"}, "frequency": 13585.0}, {"id": "BigleyFm_2", "metadata": {"Year_est": "2017", "Age": "4", "OS_location": "ST9796821801", "Lat_long": "50.9956; -2.0303288", "Establishment": "seed_mix", "pH": 7.35, "EC": 46.8, "Cutting": 1.0, "Cattle": 1.0, "Sheep": 1.0, "Plough": "1"}, "frequency": 12756.0}, {"id": "NorringtonMannorFm_1", "metadata": {"Year_est": "2009", "Age": "12", "OS_location": "ST9689721419", "Lat_long": "50.99216; -2.0455866", "Establishment": "seed_mix", "pH": 7.83, "EC": 33.5, "Cutting": 0.0, "Cattle": 0.0, "Sheep": 1.0, "Plough": "1"}, "frequency": 12594.0}, {"id": "NorringtonMannorFm_2", "metadata": {"Year_est": "2009", "Age": "12", "OS_location": "ST9699420390", "Lat_long": "50.982907; -2.0441957", "Establishment": "seed_mix", "pH": 8.2, "EC": 28.5, "Cutting": 0.0, "Cattle": 0.0, "Sheep": 1.0, "Plough": "0"}, "frequency": 13815.0}, {"id": "ManorFmBerwickStJohn_1", "metadata": {"Year_est": "2014", "Age": "7", "OS_location": "ST9468023123", "Lat_long": "51.007466; -2.0772007", "Establishment": "seed_mix", "pH": 7.47, "EC": 17.83, "Cutting": 1.0, "Cattle": 1.0, "Sheep": 1.0, "Plough": "0"}, "frequency": 12934.0}, {"id": "ManorFmBerwickStJohn_3", "metadata": {"Year_est": "2018", "Age": "3", "OS_location": "ST9422022841", "Lat_long": "51.004926; -2.0837525", "Establishment": "seed_mix", "pH": 8.36, "EC": 23.0, "Cutting": 1.0, "Cattle": 1.0, "Sheep": 1.0, "Plough": "0"}, "frequency": 13264.0}, {"id": "Jemma_1", "metadata": {"Year_est": "2010", "Age": "11", "OS_location": "SU1405276456", "Lat_long": "51.486882; -1.7990143", "Establishment": "Green_hay/bush", "pH": 8.31, "EC": 33.5, "Cutting": 1.0, "Cattle": 1.0, "Sheep": 1.0, "Plough": "0"}, "frequency": 14265.0}, {"id": "Jemma_2", "metadata": {"Year_est": "2008", "Age": "13", "OS_location": "SU1194873670", "Lat_long": "51.46188; -1.8294093", "Establishment": "Natural_regen", "pH": 7.96, "EC": 104.2, "Cutting": 0.0, "Cattle": 1.0, "Sheep": 0.0, "Plough": "0"}, "frequency": 15048.0}, {"id": "Jemma_7", "metadata": {"Year_est": "2014", "Age": "7", "OS_location": "SU1641473039", "Lat_long": "51.456096; -1.7651546", "Establishment": "Green_hay/bush", "pH": 7.95, "EC": 106.1, "Cutting": 0.0, "Cattle": 0.0, "Sheep": 1.0, "Plough": "1"}, "frequency": 16612.0}, {"id": "Jemma_4", "metadata": {"Year_est": "2015", "Age": "6", "OS_location": "SU1261971802", "Lat_long": "51.44507; -1.8198169", "Establishment": "Green_hay/bush", "pH": 7.31, "EC": 145.8, "Cutting": 1.0, "Cattle": 1.0, "Sheep": 1.0, "Plough": "0"}, "frequency": 10026.0}, {"id": "Jemma_5", "metadata": {"Year_est": "2015", "Age": "6", "OS_location": "SU1538172691", "Lat_long": "51.452995; -1.7800368", "Establishment": "seed_mix", "pH": 8.2, "EC": 77.7, "Cutting": 1.0, "Cattle": 0.0, "Sheep": 1.0, "Plough": "0"}, "frequency": 19441.0}, {"id": "Jemma_6", "metadata": {"Year_est": "2013", "Age": "8", "OS_location": "SU1560872573", "Lat_long": "51.451928; -1.7767752", "Establishment": "seed_mix", "pH": 8.54, "EC": 66.9, "Cutting": 1.0, "Cattle": 0.0, "Sheep": 1.0, "Plough": "0"}, "frequency": 17843.0}, {"id": "Jemma_9", "metadata": {"Year_est": "2015", "Age": "6", "OS_location": "SU1669072674", "Lat_long": "51.452806; -1.7611995", "Establishment": "seed_mix", "pH": 8.22, "EC": 104.9, "Cutting": 1.0, "Cattle": 0.0, "Sheep": 1.0, "Plough": "0"}, "frequency": 14148.0}, {"id": "HomeFarm_WoodlandTrust_Hampshire_good_1c", "metadata": {"Year_est": "1994", "Age": "27", "OS_location": "SU6579941829", "Lat_long": "51.171925; -1.0602025", "Establishment": "seed_mix", "pH": 6.62, "EC": 28.4, "Cutting": 0.0, "Cattle": 1.0, "Sheep": 0.0, "Plough": "0"}, "frequency": 13762.0}, {"id": "Crux_easton_70b1", "metadata": {"Year_est": "2000", "Age": "21", "OS_location": "SU4192556251", "Lat_long": "51.303843; -1.3999827", "Establishment": "seed_mix", "pH": 7.78, "EC": 80.7, "Cutting": 0.0, "Cattle": 0.0, "Sheep": 1.0, "Plough": "1"}, "frequency": 22944.0}, {"id": "Crux_easton_70b2", "metadata": {"Year_est": "2002", "Age": "19", "OS_location": "SU4195056550", "Lat_long": "51.306529; -1.399589", "Establishment": "seed_mix", "pH": 8.4, "EC": 76.3, "Cutting": 1.0, "Cattle": 0.0, "Sheep": 1.0, "Plough": "0"}, "frequency": 17256.0}, {"id": "Martin_Down_arabel_reversion", "metadata": {"Year_est": "1957", "Age": "64", "OS_location": "SU0390520162", "Lat_long": "50.980853; -1.9457471", "Establishment": "Natural_regen", "pH": 8.23, "EC": 115.8, "Cutting": 0.0, "Cattle": 0.0, "Sheep": 1.0, "Plough": "1"}, "frequency": 10844.0}, {"id": "Parsonage_down_reversion", "metadata": {"Year_est": "1945", "Age": "76", "OS_location": "SU0610341686", "Lat_long": "51.174381; -1.9140803", "Establishment": "Natural_regen", "pH": 8.12, "EC": 89.8, "Cutting": 0.0, "Cattle": 1.0, "Sheep": 0.0, "Plough": "1"}, "frequency": 12616.0}, {"id": "TARGET_MartinDown", "metadata": {"Year_est": "old", "Age": ">100", "OS_location": "SU0558918665", "Lat_long": "50.967378; -1.9217813", "Establishment": "Natural_regen", "pH": 8.05, "EC": 104.9, "Cutting": 0.0, "Cattle": 0.0, "Sheep": 1.0, "Plough": "NA"}, "frequency": 10734.0}, {"id": "TARGET_St_Catherines", "metadata": {"Year_est": "old", "Age": ">100", "OS_location": "SU4832527522", "Lat_long": "51.045025; -1.3120365", "Establishment": "Natural_regen", "pH": 7.95, "EC": 184.8, "Cutting": 0.0, "Cattle": 0.0, "Sheep": 1.0, "Plough": "NA"}, "frequency": 14056.0}, {"id": "TARGET_ParsonageDown", "metadata": {"Year_est": "old", "Age": ">100", "OS_location": "SU0552141345", "Lat_long": "51.17132; -1.9224106", "Establishment": "Natural_regen", "pH": 8.06, "EC": 112.3, "Cutting": 0.0, "Cattle": 0.0, "Sheep": 1.0, "Plough": "NA"}, "frequency": 13778.0}, {"id": "TARGET_KNEPP_A New_Barn_Field", "metadata": {"Year_est": "2006", "Age": "15", "OS_location": "TQ1420019600", "Lat_long": "50.964513; -0.3751305", "Establishment": "Natural_regen", "pH": 6.72, "EC": 48.7, "Cutting": 0.0, "Cattle": 1.0, "Sheep": 0.0, "Plough": "NA"}, "frequency": 9473.0}, {"id": "Knepp_Pond_field", "metadata": {"Year_est": "2003", "Age": "18", "OS_location": "TQ1410019300", "Lat_long": "50.961836; -0.3766479", "Establishment": "Natural_regen", "pH": 6.62, "EC": 23.5, "Cutting": 0.0, "Cattle": 1.0, "Sheep": 0.0, "Plough": "NA"}, "frequency": 13020.0}, {"id": "Knepp_Benton_field", "metadata": {"Year_est": "2005", "Age": "16", "OS_location": "TQ1450019800", "Lat_long": "50.966251; -0.37079737", "Establishment": "Natural_regen", "pH": 6.52, "EC": 27.6, "Cutting": 0.0, "Cattle": 1.0, "Sheep": 0.0, "Plough": "NA"}, "frequency": 11474.0}]}, {"transform": [{"type": "aggregate", "groupby": ["selectedCategory"]}], "name": "groupedBySelectedCategory", "source": "table"}, {"transform": [{"expr": "datum.frequency >= samplingDepth", "type": "filter"}, {"type": "aggregate", "groupby": ["selectedCategory"]}], "name": "groupedBySelectedCategoryAndRetained", "source": "table"}], "signals": [{"name": "width", "value": "", "bind": {"input": "text"}, "on": [{"events": {"source": "window", "type": "resize"}, "update": "containerSize()[0]"}]}, {"name": "chartHeight", "update": "width / 2.5"}, {"name": "chartOffset", "value": 20}, {"name": "height", "update": "chartHeight + chartOffset"}, {"name": "tooltip", "value": {}, "on": [{"events": "rect:mouseover", "update": "datum"}, {"events": "rect:mouseout", "update": "{}"}]}, {"bind": {"input": "select", "options": ["Year_est", "Age", "OS_location", "Lat_long", "Establishment", "pH", "EC", "Cutting", "Cattle", "Sheep", "Plough"], "element": "#metadata-category"}, "name": "category", "value": "Year_est"}, {"bind": {"input": "range", "element": "#sampling-depth-slider", "max": 42946, "min": 0, "step": 1}, "name": "samplingDepth", "value": 0}], "marks": [{"description": "Interactive rarefaction summary plot", "name": "rarefactionplot", "type": "group", "encode": {"enter": {"x": {"value": 0}, "y": {"signal": "chartOffset"}, "width": {"value": 200}, "height": {"signal": "chartHeight"}}}, "marks": [{"type": "rect", "from": {"data": "groupedBySelectedCategory"}, "encode": {"enter": {"x": {"scale": "xscale", "field": "selectedCategory"}, "width": {"scale": "xscale", "band": 1}, "y": {"scale": "yscale", "field": "count"}, "y2": {"scale": "yscale", "value": 0}}, "update": {"tooltip": {"signal": "{'title': datum.selectedCategory, 'Total Samples': datum.count}"}, "fill": {"value": "#D3D3D3"}, "x": {"scale": "xscale", "field": "selectedCategory"}, "width": {"scale": "xscale", "band": 1}, "y": {"scale": "yscale", "field": "count"}, "y2": {"scale": "yscale", "value": 0}}}}, {"type": "rect", "from": {"data": "groupedBySelectedCategoryAndRetained"}, "encode": {"enter": {"x": {"scale": "xscale", "field": "selectedCategory"}, "width": {"scale": "xscale", "band": 1}, "y": {"scale": "yscale", "field": "count"}, "y2": {"scale": "yscale", "value": 0}}, "update": {"tooltip": {"signal": "{'title': datum.selectedCategory, 'Samples Retained': datum.count}"}, "x": {"scale": "xscale", "field": "selectedCategory"}, "width": {"scale": "xscale", "band": 1}, "y": {"scale": "yscale", "field": "count"}, "y2": {"scale": "yscale", "value": 0}, "fill": {"value": "#1F77B4"}}, "hover": {"fill": {"value": "#60B3F7"}}}}, {"type": "text", "encode": {"enter": {"align": {"value": "center"}, "baseline": {"value": "top"}, "fill": {"value": "#000000"}}, "update": {"x": {"scale": "xscale", "signal": "tooltip.selectedCategory", "band": 0.5}, "y": {"scale": "yscale", "signal": "tooltip.count", "offset": -12}, "text": {"signal": "tooltip.count"}, "fillOpacity": [{"test": "datum === tooltip", "value": 0}, {"value": 1}]}}}], "scales": [{"name": "xscale", "type": "band", "domain": {"data": "groupedBySelectedCategory", "field": "selectedCategory", "sort": true}, "range": "width", "padding": 0.1, "round": true}, {"name": "yscale", "domain": {"fields": [{"data": "groupedBySelectedCategory", "field": "count"}]}, "nice": true, "range": [{"signal": "chartHeight"}, 0]}], "axes": [{"orient": "bottom", "scale": "xscale", "title": {"signal": "category"}, "labelAngle": 90, "labelAlign": "left", "labelBaseline": "middle"}, {"orient": "left", "scale": "yscale", "title": "Number of Samples", "tickMinStep": 1}]}]}
</script>

<script type="text/javascript">
  $(document).ready(function() {
    var spec = JSON.parse(document.getElementById("spec").innerHTML);

    // Try and come up with a good initial estimate of plot dimensions,
    // based on the browser dimensions.
    var opts = {
      width: $("#plot").width(),
      height: $("#plot").width() / 2.5
    };

    vegaEmbed("#plot", spec, opts)
      .then(function(result) {
        result.view.logLevel(vega.Warn);
        // Stash the view object in global namespace for debugging purposes.
        // Check out https://vega.github.io/vega/docs/api/debugging/
        // for more details.
        window.v = result.view;
      })
      .catch(function(error) {
        // From 'js-error-handler.html'
        handleErrors([error], $("#plot"));
      });

    // Clean up the vega-embed toolbar
    var toolbar = $("div .vega-actions").detach();
    toolbar.addClass("btn-group");
    toolbar.children("a").each(function() {
      // NOTE: We're just skipping this bit until we get the plot working with
      // Vega 5
      if(this.innerHTML == "Open in Vega Editor"){
        this.remove()
        return true
      }
      $(this).addClass("btn btn-default");
    });

    toolbar.appendTo("#toolbar");

    var category = $("#metadata-category .vega-bind");
    category
      .children(".vega-bind-name")
      .replaceWith("<label> Metadata Category &nbsp;</label>");
    category.children("select").addClass("form-control");

    var samplingDepthSlider = $("#sampling-depth-slider .vega-bind");
    $(samplingDepthSlider)
      .find("label")
      .remove();
    $(samplingDepthSlider)
      .find("input")
      .attr("id", "range-slider");
    $(samplingDepthSlider)
      .find("input")
      .attr("oninput", "sliderHelperFunction(this.value);");
    $(samplingDepthSlider).prepend(
      "<label> Sampling Depth &nbsp; </label> <br>"
    );
    $(samplingDepthSlider).append(
      '<br> <input id="text-box" class="form-control" type="number" value="0" min="0" oninput="textBoxHelperFunction(this.value);" />'
    );
    $(samplingDepthSlider).append("(zero implies no even sampling)");
    samplingDepthSlider.children(".vega-bind-name").replaceWith("");

    var rotateLabels = $("#rotate-labels .vega-bind");
    rotateLabels
      .children(".vega-bind-name")
      .replaceWith("<label> Rotate Labels &nbsp;</label>");
    rotateLabels.children("checkbox").addClass("form-control");
  });
</script>


<div class="row">
  <div class="col-lg-8">
    <table id="feature-table" class="table table-striped">
      <thead>
        <tr>
          <th scope="col">Sample ID</th>
          <th scope="col">Feature Count</th>
        </tr>
      </thead>
      <tbody id="table-body"></tbody>
    </table>
  </div>
</div>

<script id="table-data" type="application/json">
{"TownsendFarm_1":42946.0,"Bradenham_post-1986_b":39538.0,"Stonehenge_2011":39326.0,"Stonehenge_2009":38690.0,"RSPB_junction":38603.0,"Stonehenge_2000_2017a":38504.0,"TownsendFarm_3_big":37937.0,"StowellFarms_1_adj":37901.0,"Stonehenge_2002_2017":36570.0,"Stonehenge_2005":36346.0,"Watlington_natural_reversion":35772.0,"HARLEY_FARMS_New1":35726.0,"HARLEY_FARMS_Chittern":35642.0,"HARLEY_FARMS_new2b":35630.0,"Stonehenge_2007_2016":35339.0,"Stonehenge_2003_2017b":35169.0,"Stonehenge_-_Luxenborough_BankB":34598.0,"Toposcope_Field_-_1980s":33224.0,"DRUIDS":32519.0,"Stonehenge_2010":32292.0,"Stratton_Wood":29263.0,"ChurchFarm":29146.0,"RSPB_orig_green":28826.0,"RSPB_Mainline":28713.0,"St_Catherines_A3":27693.0,"TownsendFarm_2":25856.0,"Whitelands_2018\/19_":25680.0,"Castle_Field_West_(W)":24979.0,"RSPB_churchil":24264.0,"Baltic_farm_2":24064.0,"Crux_easton_70b1":22944.0,"WINDMILL_farm":22761.0,"HorntonHouseFarm_1_parallel":21680.0,"HommingtonFarm":21063.0,"Jemma_5":19441.0,"Lardon_Chase_The_Holies_motorcycle":18721.0,"WESTMEAD_FARM":18226.0,"Jemma_6":17843.0,"Baltic_farm_1":17279.0,"Crux_easton_70b2":17256.0,"Jemma_7":16612.0,"MannorFmAltonBarnes":16267.0,"Jemma_2":15048.0,"Jemma_1":14265.0,"Jemma_9":14148.0,"TARGET_St_Catherines":14056.0,"WestEndFarm":13985.0,"NorringtonMannorFm_2":13815.0,"ThropeManor_3":13807.0,"TARGET_ParsonageDown":13778.0,"HomeFarm_WoodlandTrust_Hampshire_good_1c":13762.0,"BigleyFm_1":13585.0,"ManorFmBerwickStJohn_3":13264.0,"Knepp_Pond_field":13020.0,"ManorFmBerwickStJohn_1":12934.0,"BigleyFm_2":12756.0,"MannorFmBroadChalke":12750.0,"ThropeManor_2":12626.0,"Parsonage_down_reversion":12616.0,"NorringtonMannorFm_1":12594.0,"ThropeManor_1":11842.0,"Knepp_Benton_field":11474.0,"Martin_Down_arabel_reversion":10844.0,"TARGET_MartinDown":10734.0,"Jemma_4":10026.0,"TARGET_KNEPP_A New_Barn_Field":9473.0}
</script>

<script type="text/javascript">
  var totalFrequencies = 1538051;
  var sampleCount = 66;
  var defaultDescription = "Retained " + (totalFrequencies.toLocaleString('en'))
                                       + " (100.00%) features in "
                                       + sampleCount + " (100.00%) samples at the specifed sampling depth.";


  var textField = document.getElementById('text-field');
  var tableBody = document.getElementById("table-body");
  var table = document.getElementById("feature-table");

  // when the viz loads the default description is displayed
  textField.innerHTML = defaultDescription;

  var sampleFrequency = JSON.parse(document.getElementById("table-data").innerHTML);
  // get object keys and store them in an ascending order based on the key value
  // this order is used to create the table rows
  sortedSampleIDs = Object.keys(sampleFrequency).sort(function(a, b) {
    var temp = sampleFrequency[a] - sampleFrequency[b];
    // if two samples have the same number of features then we
    // determine the order using the sample ID alphabetical order
    if (temp == 0){
      return b.localeCompare(a);
    }

  return temp;
  });

  sortedSampleIDs.forEach(function(element) {
    var row = tableBody.insertRow(0);
    var cell1 = row.insertCell(0);
    var cell2 = row.insertCell(1);
    cell1.innerHTML = element;
    cell2.innerHTML = sampleFrequency[element];

  });


  function updateTableandText(val) {
    var retainedSampleCount = 0;

    // start the counter at 1 to ignore the header row
    for (var i = 1; row = table.rows[i]; i++) {

      if (Number(row.cells[1].innerHTML) < val) {
        row.className = "danger";
      } else {
        row.className = "";
        retainedSampleCount += 1;
      }
    }
    if (val == 0){

    textField.innerHTML = defaultDescription;

    }
    else{
      var retainedFeatureCount = retainedSampleCount * val;
      textField.innerHTML = "Retained " + retainedFeatureCount.toLocaleString('en')
                                        + " (" + (retainedFeatureCount/totalFrequencies*100).toFixed(2) + "%) features in "
                                        + retainedSampleCount + " (" + (retainedSampleCount/sampleCount*100).toFixed(2)
                                        +  "%) samples at the specifed sampling depth.";
    }

  }


  function updateSliderVal(val) {
    var slider = document.getElementById("range-slider");
    slider.value = val;
    slider.dispatchEvent(new Event("change"));
    slider.dispatchEvent(new Event("input"));
  }


  function updateBoxVal(val) {
    var num = document.getElementById("text-box");
    num.value = val;
  }


  function sliderHelperFunction(val){
    updateBoxVal(val);
    updateTableandText(val);

  }


  function textBoxHelperFunction(val){
    val = parseInt(val);
    if (val !== val) {
      val = 0;
    }

    // make sure the value in the textbox cannot exceed the max count
    if (val > 42946.0){
      var num = document.getElementById("text-box");
      num.value = 42946.0;
    }
    updateSliderVal(val);
  }
</script>


    </div>
  </div>


    </div>
    <script type="text/javascript">
      if (window.frameElement) {
          document.getElementById('q2templatesheader').remove();
      }
    </script>
    

  </body>
</html>